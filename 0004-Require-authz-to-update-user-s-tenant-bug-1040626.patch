From d8c71909022fd7110d73ba6ccfbcf1f40187eff9 Mon Sep 17 00:00:00 2001
From: Dolph Mathews <dolph.mathews@gmail.com>
Date: Thu, 23 Aug 2012 07:39:20 -0500
Subject: [PATCH] Require authz to update user's tenant (bug 1040626)

Change-Id: I82f80b84af2bc4db00b3dcb87a2ec338816a82e9
---
 keystone/identity/core.py |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

diff --git a/keystone/identity/core.py b/keystone/identity/core.py
index aec0b75..c9c496c 100644
--- a/keystone/identity/core.py
+++ b/keystone/identity/core.py
@@ -515,6 +515,7 @@ class UserController(wsgi.Application):
 
     def update_user_tenant(self, context, user_id, user):
         """Update the default tenant."""
+        self.assert_admin(context)
         # ensure that we're a member of that tenant
         tenant_id = user.get('tenantId')
         self.identity_api.add_user_to_tenant(context, tenant_id, user_id)
